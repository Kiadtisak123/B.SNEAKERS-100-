<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>B.Sneakers | หน้าแรก</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
<style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Kanit', sans-serif}
    body{background:#0f0f0f;color:#fff; overflow-x: hidden;}
    header{background:#111;padding:15px 30px;display:flex;justify-content:space-between;align-items:center;border-bottom:2px solid #e60023;position:sticky;top:0;z-index:1000}
    .logo{font-size:24px;font-weight:bold;color:#e60023;text-decoration:none}
    .logo span { color: #fff; }
    nav{display:flex;align-items:center;gap:15px}
    nav a{color:#fff;text-decoration:none;font-size:14px;transition:.3s;padding:5px 10px;}
    nav a:hover{color:#e60023}
    .user-profile-tag { display: none; align-items: center; gap: 10px; background: rgba(255,255,255,0.05); padding: 5px 12px; border-radius: 50px; border: 1px solid #333; cursor: pointer; }
    .user-avatar-mini { width: 28px; height: 28px; border-radius: 50%; object-fit: cover; border: 1.5px solid #e60023; }
    .icon-btn{cursor:pointer;background:#1a1a1a;padding:10px;border-radius:12px;border:1px solid #222;color:white;text-decoration: none;position:relative;}
    #cartCount{position:absolute;top:-8px;right:-8px;background:#e60023;color:#fff;font-size:11px;padding:2px 6px;border-radius:50%;}
    .hero{background:linear-gradient(rgba(0,0,0,.7),rgba(0,0,0,.9)),url('https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=1200');background-size:cover;background-position:center;padding:100px 20px;text-align:center}
    .section{padding:40px 20px;max-width:1200px;margin:auto}
    .grid{display:grid;grid-template-columns:repeat(auto-fill, minmax(250px, 1fr));gap:20px}
    .card{background:#1a1a1a;border-radius:15px;overflow:hidden;border:1px solid #222;cursor:pointer;transition:.3s;}
    .card:hover{transform:translateY(-5px);border-color:#e60023;}
    .card img{width:100%;height:200px;object-fit:cover;}
    .card-body{padding:15px;}
    .price{color:#e60023;font-size:20px;font-weight:bold;}
    .admin-fab { position: fixed; bottom: 30px; right: 30px; background: #ffc107; color: #000; width: 60px; height: 60px; border-radius: 50%; display: none; align-items: center; justify-content: center; z-index: 9999; text-decoration: none;}
</style>
</head>
<body>
<header>
    <a href="./index.html" class="logo">B.<span>SNEAKERS</span></a>
    <nav>
        <a href="./index.html">หน้าแรก</a>
        <a href="./product.html">สินค้า</a>
        <a href="./orders.html" id="orderLink" style="display:none;">ประวัติสั่งซื้อ</a>
        <a href="./login.html" id="loginLink">เข้าสู่ระบบ</a>
        <div id="userDisplay" class="user-profile-tag" onclick="location.href='./profile.html'">
            <img id="userAvatarHeader" src="" class="user-avatar-mini" style="display:none;">
            <i id="userDefaultIcon" class="fa-solid fa-circle-user" style="color:#e60023;"></i>
            <span id="userNameText"></span>
        </div>
        <a href="./cart.html" class="icon-btn"><i class="fa-solid fa-cart-shopping"></i><span id="cartCount">0</span></a>
        <div class="icon-btn" id="logoutBtn" onclick="handleLogout()" style="display:none;"><i class="fa-solid fa-right-from-bracket"></i></div>
    </nav>
</header>
<a href="./admin.html" id="adminFab" class="admin-fab"><i class="fa-solid fa-user-gear"></i></a>
<section class="hero">
    <h1>B.SNEAKERS STORE</h1>
    <p>รองเท้ามือสองของแท้ สภาพดี ราคาเป็นกันเอง</p>
</section>
<section class="section">
    <h2>สินค้าแนะนำ</h2>
    <div class="grid" id="productGrid"></div>
</section>
<script>
function checkAuth() {
    const user = JSON.parse(localStorage.getItem("currentUser"));
    if (user) {
        document.getElementById("loginLink").style.display = "none";
        document.getElementById("userDisplay").style.display = "flex";
        document.getElementById("userNameText").textContent = user.username;
        document.getElementById("logoutBtn").style.display = "flex";
        document.getElementById("orderLink").style.display = "inline-block";
        if(user.avatar) {
            const img = document.getElementById("userAvatarHeader");
            img.src = user.avatar; img.style.display = "block";
            document.getElementById("userDefaultIcon").style.display = "none";
        }
        if (user.role === "admin") document.getElementById("adminFab").style.display = "flex";
    }
}
function renderProducts() {
    const grid = document.getElementById("productGrid");
    const products = JSON.parse(localStorage.getItem('sneaker_prods')) || [];
    grid.innerHTML = products.reverse().slice(0, 8).map(p => `
        <div class="card" onclick="goToDetail('${p.id}')">
            <img src="${(p.images && p.images[0]) || p.img || 'https://via.placeholder.com/400'}" onerror="this.src='https://via.placeholder.com/400'">
            <div class="card-body">
                <h3>${p.name}</h3>
                <div class="price">฿${Number(p.price).toLocaleString()}</div>
            </div>
        </div>`).join('');
}
function goToDetail(id) {
    const products = JSON.parse(localStorage.getItem('sneaker_prods')) || [];
    const found = products.find(item => String(item.id) === String(id));
    if (found) { localStorage.setItem("selectedProduct", JSON.stringify(found)); window.location.href = "./detail.html"; }
}
function handleLogout() {
    localStorage.removeItem("currentUser");
    window.location.href = "./index.html";
}
window.onload = () => { checkAuth(); renderProducts(); };
</script>
</body>
</html>
